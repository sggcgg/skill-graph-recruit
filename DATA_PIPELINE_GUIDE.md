# ğŸ“Š å®Œæ•´æ•°æ®å¤„ç†æµç¨‹æŒ‡å—

> **é€‚ç”¨äº**: Qwen2.5-1.5B + vLLM (8GBæ˜¾å­˜ç¨³å®šç‰ˆ)
> **æ›´æ–°æ—¥æœŸ**: 2026-02-10

---

## ğŸ¯ æ•°æ®å¤„ç†å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. çˆ¬å–åŸå§‹æ•°æ®  â”‚  boss_listdata.py
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ•°æ®æ¸…æ´—      â”‚  data_cleaner.py
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æŠ€èƒ½å¢å¼º      â”‚  enhance_with_qwen3.py (Qwen2.5-1.5B)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å¯¼å…¥Neo4j     â”‚  reimport_neo4j.py
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å‘é‡åŒ–å­˜å‚¨    â”‚  init_vector_db.py
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. å¯åŠ¨API       â”‚  run_api.py
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ å½“å‰æ•°æ®é—®é¢˜

### é—®é¢˜1: ç¼ºå°‘JDæè¿°å­—æ®µ

**ç°çŠ¶**ï¼š
- âŒ çˆ¬è™«åªæŠ“å–äº†åˆ—è¡¨æ•°æ®ï¼ˆtitle, salaryç­‰ï¼‰
- âŒ æ²¡æœ‰æŠ“å–è¯¦æƒ…é¡µçš„èŒä½æè¿°
- âŒ æ— æ³•ç”¨LLMæå–æŠ€èƒ½ï¼ˆå› ä¸ºæ²¡æœ‰æ–‡æœ¬ï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### æ–¹æ¡ˆA: é‡æ–°çˆ¬å–ï¼ˆæ¨èï¼‰
ä¿®æ”¹çˆ¬è™«ä»£ç ï¼Œè¿›å…¥è¯¦æƒ…é¡µæŠ“å–JDæè¿°ï¼š

```python
# åœ¨ boss_listdata.py ä¸­æ·»åŠ è¯¦æƒ…é¡µæŠ“å–
def fetch_job_detail(self, job_url):
    """æŠ“å–èŒä½è¯¦æƒ…"""
    try:
        self.tab.get(job_url)
        time.sleep(2)
        
        # è·å–èŒä½æè¿°
        jd_description = self.tab.ele('css:.job-detail-section').text
        
        return {
            'description': jd_description
        }
    except Exception as e:
        self.logger.error(f"æŠ“å–è¯¦æƒ…å¤±è´¥: {e}")
        return None
```

#### æ–¹æ¡ˆB: ä½¿ç”¨ç°æœ‰æ•°æ®
å¦‚æœä¸æƒ³é‡æ–°çˆ¬å–ï¼Œå¯ä»¥ï¼š
1. ä»title + skillsæ„å»ºä¼ªJD
2. è´¨é‡ä¼šé™ä½ï¼Œä½†èƒ½è·‘é€šæµç¨‹

---

## ğŸ“ æ“ä½œæ­¥éª¤è¯¦è§£

### Step 1: çˆ¬å–åŸå§‹æ•°æ®

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /mnt/d/PycharmProjects/skill-graph-recruit

# æ¿€æ´»ç¯å¢ƒ
source ~/.venv-skill-graph/bin/activate

# è¿è¡Œçˆ¬è™«
python src/crawler/boss_listdata.py
```

**è¾“å‡ºä½ç½®**: `data/raw/boss_{åŸå¸‚}.json`

**æ•°æ®æ ¼å¼**ï¼ˆç†æƒ³çŠ¶æ€ï¼‰:
```json
{
  "job_id": "xxx",
  "title": "Pythonå¼€å‘å·¥ç¨‹å¸ˆ",
  "company": "åä¸ºæŠ€æœ¯",
  "city": "åŒ—äº¬",
  "salary_min": 20,
  "salary_max": 30,
  "skills": ["Python", "Django"],
  "description": "å²—ä½èŒè´£ï¼š1. è´Ÿè´£...\nä»»èŒè¦æ±‚ï¼š1. ç†Ÿæ‚‰..."  // â† è¿™ä¸ªå­—æ®µç¼ºå¤±ï¼
}
```

---

### Step 2: æ•°æ®æ¸…æ´—

```bash
# æ–¹å¼1: ä½¿ç”¨è„šæœ¬ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
python src/data_processing/data_cleaner.py

# æ–¹å¼2: æ‰‹åŠ¨æ¸…æ´—ï¼ˆå½“å‰æƒ…å†µï¼‰
# ä½ çš„æ•°æ®å·²ç»æ¸…æ´—è¿‡äº†ï¼Œåœ¨ data/cleaned/ ç›®å½•
```

**æ¸…æ´—è§„åˆ™**:
- âœ… å»é‡ï¼ˆåŸºäºjob_idï¼‰
- âœ… è¿‡æ»¤æ— æ•ˆè–ªèµ„
- âœ… è¿‡æ»¤ç©ºskillsï¼ˆå¯é€‰ï¼‰
- âœ… æ ‡å‡†åŒ–å­—æ®µ

**è¾“å‡ºä½ç½®**: `data/cleaned/boss_{åŸå¸‚}_cleaned.json`

---

### Step 3: æŠ€èƒ½å¢å¼ºï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰

```bash
# ä½¿ç”¨Qwen2.5-1.5B + vLLMå¢å¼ºæŠ€èƒ½æå–
python scripts/enhance_with_qwen3.py
```

**å¤„ç†æµç¨‹**:
1. **ä¸»åŠ¨å­¦ä¹ é‡‡æ ·**: ä»70,000æ¡é€‰å‡º10,000æ¡ä»£è¡¨æ€§æ ·æœ¬
2. **Qwen2.5æ¨ç†**: LLMæå–æŠ€èƒ½ï¼ˆéœ€è¦JDæè¿°ï¼ï¼‰
3. **çŸ¥è¯†è’¸é¦**: è®­ç»ƒLightGBMæ¨¡å‹
4. **æ‰¹é‡å¤„ç†**: è’¸é¦æ¨¡å‹å¤„ç†å‰©ä½™60,000æ¡

**âš ï¸ å½“å‰é—®é¢˜**: 
- ä½ çš„æ•°æ®**æ²¡æœ‰JDæè¿°**ï¼Œæ— æ³•è¿è¡Œæ­¤æ­¥éª¤ï¼
- éœ€è¦å…ˆè§£å†³æ•°æ®é—®é¢˜

**è¾“å‡ºä½ç½®**: `data/enhanced/qwen3_distill_10k.json`

---

### Step 4: å¯¼å…¥Neo4j

```bash
python scripts/reimport_neo4j.py
```

**é€‰æ‹©æ•°æ®æº**:
```
[1] data/enhanced/qwen3_distill_10k.json (å¢å¼ºåï¼Œæ¨è)
[2] data/cleaned/boss_*_cleaned.json (ä»…è§„åˆ™æå–)
```

---

### Step 5: åˆå§‹åŒ–å‘é‡æ•°æ®åº“

```bash
python scripts/init_vector_db.py
```

**æ”¯æŒå¢é‡æ›´æ–°ï¼** âœ…

---

## ğŸ”„ å¢é‡æ•°æ®æ›´æ–°ï¼ˆé‡è¦ï¼‰

### é—®é¢˜ï¼šåˆ†æ‰¹æ¬¡å¯¼å…¥ä¼šæœ‰é—®é¢˜å—ï¼Ÿ

**ç­”æ¡ˆ**: âœ… **å®Œå…¨æ²¡é—®é¢˜**ï¼ChromaDBåŸç”Ÿæ”¯æŒå¢é‡æ·»åŠ ã€‚

### å¢é‡æ›´æ–°æ“ä½œ

#### åœºæ™¯1: ç¬¬ä¸€æ‰¹7ä¸‡æ¡

```bash
# 1. åˆå§‹åŒ–å‘é‡æ•°æ®åº“
python scripts/init_vector_db.py

# é€‰æ‹©: å¦ï¼ˆä¸æ¸…ç©ºï¼‰
æ˜¯å¦æ¸…ç©ºå¹¶é‡æ–°å¯¼å…¥? (y/n): n  # ç¬¬ä¸€æ¬¡å¯ä»¥é€‰y
```

#### åœºæ™¯2: æ–°å¢30ä¸‡æ¡

```python
# æ–¹æ³•1: ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
python scripts/init_vector_db.py

# å®ƒä¼šæ£€æµ‹åˆ°å·²æœ‰æ•°æ®ï¼Œè¯¢é—®æ˜¯å¦è¿½åŠ 
# é€‰æ‹©: è¿½åŠ ï¼ˆappendï¼‰

# æ–¹æ³•2: è‡ªå®šä¹‰è„šæœ¬
from src.rag.vector_db import VectorDB
import json

# åˆå§‹åŒ–
db = VectorDB()

# åŠ è½½æ–°æ•°æ®
with open('data/cleaned/new_batch.json') as f:
    new_jobs = json.load(f)

# å¢é‡æ·»åŠ ï¼ˆä¸å½±å“å·²æœ‰æ•°æ®ï¼‰
db.add_jobs(new_jobs, batch_size=50)

print(f"æ·»åŠ å®Œæˆï¼æ€»æ–‡æ¡£æ•°: {db.get_stats()['total_documents']}")
```

**å…³é”®ç‚¹**:
- âœ… ChromaDBè‡ªåŠ¨å¤„ç†ID
- âœ… æ”¯æŒå¹¶å‘æŸ¥è¯¢
- âœ… ä¸ä¼šé‡å¤æ·»åŠ ï¼ˆåŸºäºIDï¼‰
- âœ… æ€§èƒ½ä¸å—å½±å“

---

## ğŸ“Š æ•°æ®çŠ¶æ€æ£€æŸ¥

### æŸ¥çœ‹å½“å‰æ•°æ®

```bash
# 1. åŸå§‹æ•°æ®
ls -lh data/raw/

# 2. æ¸…æ´—åæ•°æ®
ls -lh data/cleaned/

# 3. å¢å¼ºåæ•°æ®
ls -lh data/enhanced/

# 4. å‘é‡æ•°æ®åº“çŠ¶æ€
python -c "
from src.rag.vector_db import VectorDB
db = VectorDB()
print(f'æ–‡æ¡£æ€»æ•°: {db.get_stats()[\"total_documents\"]}')
"
```

### æ£€æŸ¥æ•°æ®è´¨é‡

```python
# æ£€æŸ¥æ˜¯å¦æœ‰JDæè¿°
import json
with open('data/cleaned/boss_åŒ—äº¬_cleaned.json') as f:
    jobs = json.load(f)
    
first_job = jobs[0]
print("æ•°æ®å­—æ®µ:", first_job.keys())
print("æ˜¯å¦æœ‰description:", 'description' in first_job)
print("æ˜¯å¦æœ‰jd:", 'jd' in first_job)
```

---

## ğŸ”§ è§£å†³å½“å‰é—®é¢˜çš„ä¸´æ—¶æ–¹æ¡ˆ

ç”±äºä½ çš„æ•°æ®**ç¼ºå°‘JDæè¿°**ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹ä¸´æ—¶æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ1: æ„å»ºä¼ªJDï¼ˆåº”æ€¥ï¼‰

```python
# ä¿®æ”¹ scripts/enhance_with_qwen3.py
def build_pseudo_jd(job):
    """ä»ç°æœ‰å­—æ®µæ„å»ºä¼ªJD"""
    title = job.get('title', '')
    skills = ', '.join(job.get('skills', []))
    experience = job.get('experience', '')
    education = job.get('education', '')
    
    pseudo_jd = f"""
    èŒä½: {title}
    æŠ€èƒ½è¦æ±‚: {skills}
    å·¥ä½œç»éªŒ: {experience}
    å­¦å†è¦æ±‚: {education}
    """
    return pseudo_jd
```

### æ–¹æ¡ˆ2: è·³è¿‡LLMå¢å¼ºï¼ˆä¿å®ˆï¼‰

ç›´æ¥ä½¿ç”¨è§„åˆ™æå–çš„skills:
```bash
# è·³è¿‡å¢å¼ºï¼Œç›´æ¥å¯¼å…¥Neo4j
python scripts/reimport_neo4j.py
# é€‰æ‹©: [2] data/cleaned/boss_*_cleaned.json
```

---

## ğŸ“ˆ å®Œæ•´ç¤ºä¾‹ï¼šå¤„ç†æ–°æŠ“å–çš„æ•°æ®

å‡è®¾ä½ æŠ“å–äº†æ–°çš„30ä¸‡æ¡æ•°æ®ï¼š

```bash
# 1. æŠ“å–
python src/crawler/boss_listdata.py
# è¾“å‡º: data/raw/boss_æ–°åŸå¸‚.json

# 2. æ¸…æ´—
python src/data_processing/data_cleaner.py
# è¾“å‡º: data/cleaned/boss_æ–°åŸå¸‚_cleaned.json

# 3. æŠ€èƒ½å¢å¼ºï¼ˆéœ€è¦JDæè¿°ï¼ï¼‰
python scripts/enhance_with_qwen3.py
# è¾“å‡º: data/enhanced/æ–°æ‰¹æ¬¡.json

# 4. æ›´æ–°Neo4j
python scripts/reimport_neo4j.py
# é€‰æ‹©: è¿½åŠ æ¨¡å¼

# 5. æ›´æ–°å‘é‡åº“
python scripts/init_vector_db.py
# é€‰æ‹©: è¿½åŠ æ¨¡å¼
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### æ•°æ®ç®¡ç†ç­–ç•¥

1. **æŒ‰æ‰¹æ¬¡ç®¡ç†**
   ```
   data/
   â”œâ”€â”€ raw/
   â”‚   â”œâ”€â”€ batch1_åŒ—äº¬.json
   â”‚   â””â”€â”€ batch2_åŒ—äº¬.json
   â”œâ”€â”€ cleaned/
   â”‚   â”œâ”€â”€ batch1_åŒ—äº¬_cleaned.json
   â”‚   â””â”€â”€ batch2_åŒ—äº¬_cleaned.json
   â””â”€â”€ enhanced/
       â”œâ”€â”€ batch1_enhanced.json
       â””â”€â”€ batch2_enhanced.json
   ```

2. **å¢é‡æ›´æ–°**
   - Neo4j: æ”¯æŒMERGEï¼ˆä¸é‡å¤ï¼‰
   - ChromaDB: æ”¯æŒå¢é‡addï¼ˆåŸºäºIDï¼‰
   - å»ºè®®ï¼šæ¯æ¬¡æ–°å¢å‰å¤‡ä»½

3. **æ•°æ®å¤‡ä»½**
   ```bash
   # å¤‡ä»½å‘é‡æ•°æ®åº“
   cp -r data/vector_db/ data/vector_db_backup_$(date +%Y%m%d)/
   
   # å¤‡ä»½Neo4jï¼ˆå¯¼å‡ºï¼‰
   python scripts/export_neo4j.py
   ```

---

## ğŸš¨ å…³é”®æ³¨æ„äº‹é¡¹

1. âš ï¸ **JDæè¿°å­—æ®µå¿…éœ€**ï¼š
   - æ²¡æœ‰JDæè¿°ï¼ŒLLMæ— æ³•å·¥ä½œ
   - å¿…é¡»ä¿®æ”¹çˆ¬è™«æˆ–è¡¥å……æ•°æ®

2. âœ… **å¢é‡æ›´æ–°å®Œå…¨æ”¯æŒ**ï¼š
   - ChromaDBåŸç”Ÿæ”¯æŒ
   - Neo4jä½¿ç”¨MERGEè¯­å¥
   - ä¸ä¼šå½±å“å·²æœ‰æ•°æ®

3. ğŸ“Š **æ•°æ®ä¸€è‡´æ€§**ï¼š
   - ç¡®ä¿job_idå”¯ä¸€
   - åŒä¸€æ¡æ•°æ®ä¸è¦é‡å¤å¯¼å…¥
   - å®šæœŸæ£€æŸ¥æ•°æ®è´¨é‡

4. ğŸ’¾ **æ€§èƒ½å»ºè®®**ï¼š
   - æ‰¹é‡å¤„ç†ï¼ˆbatch_size=50-100ï¼‰
   - åˆ†æ‰¹æ¬¡å¯¼å…¥å¤§æ•°æ®é›†
   - å®šæœŸæ¸…ç†æ— æ•ˆæ•°æ®

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤æ•°æ®ï¼Ÿ

```python
from src.rag.vector_db import VectorDB
db = VectorDB()

# æ£€æŸ¥æ€»æ•°
stats = db.get_stats()
print(f"æ€»æ–‡æ¡£æ•°: {stats['total_documents']}")

# æ£€æŸ¥æ ·æœ¬
results = db.query("Python", top_k=5)
for r in results['results']:
    print(r['metadata']['job_id'])
```

### Q2: å¦‚ä½•åˆ é™¤ç‰¹å®šæ‰¹æ¬¡çš„æ•°æ®ï¼Ÿ

```python
from src.rag.vector_db import VectorDB
db = VectorDB()

# æ ¹æ®æ¡ä»¶åˆ é™¤ï¼ˆéœ€è¦å®ç°ï¼‰
# ç›®å‰åªæ”¯æŒå…¨éƒ¨æ¸…ç©º
db.clear()
```

### Q3: å‘é‡æ•°æ®åº“å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ

```bash
# æŸ¥çœ‹å¤§å°
du -sh data/vector_db/

# å®šæœŸæ¸…ç†
python -c "
from src.rag.vector_db import VectorDB
db = VectorDB()
db.clear()  # æ¸…ç©ºæ‰€æœ‰æ•°æ®
"
```

---

## ğŸ“ æ€»ç»“

**ä½ çš„å½“å‰çŠ¶æ€**:
- âœ… æœ‰7ä¸‡æ¡æ¸…æ´—åçš„æ•°æ®
- âŒ ç¼ºå°‘JDæè¿°å­—æ®µ
- âš ï¸ æ— æ³•è¿è¡ŒLLMå¢å¼º

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. **ç´§æ€¥**: ä¿®æ”¹çˆ¬è™«ï¼ŒæŠ“å–JDæè¿°
2. æˆ–ä½¿ç”¨ä¸´æ—¶æ–¹æ¡ˆæ„å»ºä¼ªJD
3. ç„¶åæŒ‰ç…§å®Œæ•´æµç¨‹å¤„ç†

**å¢é‡æ›´æ–°ç­–ç•¥**:
- å®Œå…¨æ”¯æŒï¼Œæ— éœ€æ‹…å¿ƒ
- æ¯æ¬¡æ–°å¢å‰å»ºè®®å¤‡ä»½
- ç¡®ä¿job_idå”¯ä¸€æ€§

éœ€è¦æˆ‘å¸®ä½ ä¿®æ”¹çˆ¬è™«ä»£ç ï¼Œæ·»åŠ JDæè¿°æŠ“å–åŠŸèƒ½å—ï¼Ÿ
